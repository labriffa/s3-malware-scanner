# s3-malware-scanner
Uses VirusTotal to scan S3 files as they get populated into buckets

## Basic Workflow
* A lambda trigger is applied to any S3 Post/Put that gets added to a specified bucket
* A lambda function is used to query the VirusTotal API and retrieve a scan URL
* The scan URL is added to an SQS scan queue to query the results of this scan at a later interval
* The SQS scan queue triggers a lambda function that queries VirusTotal to gather the resulting scan report
* Any suspicious files are added to an SQS quarantine queue for future deletion

## Getting Started
These instructions will get you a copy of the project up and running on your AWS account.

### Lambda Functions
S3 Malware Scanner works off a number of lambda functions that are available in the build directory of the application, the lambda function zip's should respectively be added to a bucket called **lambda-functions-s3-scanner** this can alternatively be overriden by passing in a value for the **S3MalwareScannerLambdaBucketName** parameter upon the creation of the CloudFormation stack.  

### Deployment via CloudFormation
```
aws --region ${AWS_REGION} cloudformation create-stack --capabilities CAPABILITY_NAMED_IAM --stack-name totalvirus-stack --template-body file://totalvirus-stack.json --parameters ParameterKey=TotalVirusApiKeyParameter,ParameterValue=${TOTALVIRUS_API_KEY}
```

## Dependencies
* request
* dotenv

## Author
* Lewis Alberto Briffa
