'use strict';

const VirusScanner = require('./VirusScanner');
const fs = require('fs');
const mockVirusScanResponse = fs.readFileSync(`${__dirname}/mockResponses/virusScanner/fileScanResponse.json`);
const mockVirusReportResponse = fs.readFileSync(`${__dirname}/mockResponses/virusScanner/fileReportResponse.json`);

module.exports = class MockVirusTotalAPI extends VirusScanner {
	constructor() {
		super();
	}

	fileScan(file) {
		return new Promise((resolve, reject) => {
			if (Buffer.from(file, 'base64').toString('base64') === file) {
				resolve(mockVirusScanResponse);
			} else {
				reject('Not a valid file format');
			}
		});
	}

	fileReport(scanId) {
		return new Promise((resolve, reject) => {
			if (scanId) {
				resolve(mockVirusReportResponse);
			} else {
				reject('No scan_id specified');
			}
		});
	}
}