'use strict';

const Message = require('./Message');

module.exports = class MalwareScanMessage extends Message {
	constructor(scanData, bucketName, key) {
		super();

		this.params = {
			DelaySeconds: process.env.AWS_SCAN_SQS_DELAY_SECONDS,
			MessageAttributes: {
				"ScanId": {
					DataType: "String",
					StringValue: scanData.scan_id
				},
				"Permalink": {
					DataType: "String",
					StringValue: scanData.permalink
				},
				"S3BucketName": {
					DataType: "String",
					StringValue: bucketName
				},
				"S3Key": {
					DataType: "String",
					StringValue: key
				}
			},
			MessageBody: scanData.verbose_msg,
			QueueUrl: process.env.AWS_SCAN_SQS_URL
		};
	}
}