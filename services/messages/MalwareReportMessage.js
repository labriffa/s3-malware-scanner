const Message = require('./Message');

module.exports = class MalwareReportMessage extends Message {
	constructor(s3bucketName, s3key, body) {
		super();

		this.params = {
			DelaySeconds: process.env.AWS_QUARANTINE_SQS_DELAY_SECONDS,
			MessageAttributes: {
				"S3BucketName": {
					DataType: "String",
					StringValue: s3bucketName
				},
				"S3Key": {
					DataType: "String",
					StringValue: s3key
				}
			},
			MessageBody: body,
			QueueUrl: process.env.AWS_QUARANTINE_SQS_URL
		}
	}
}